import{_ as n,c as a,e,d as p}from"./app-yBO_JKoh.js";const t={};function o(c,s){return p(),a("div",null,s[0]||(s[0]=[e(`<h1 id="headers" tabindex="-1"><a class="header-anchor" href="#headers"><span>Headers</span></a></h1><p>Volga makes it possible to easily manage HTTP headers, both for reading from requests and writing to responses.</p><h2 id="reading-request-headers" tabindex="-1"><a class="header-anchor" href="#reading-request-headers"><span>Reading Request Headers</span></a></h2><p>To read headers from an incoming request, you can use <a href="https://docs.rs/volga/latest/volga/headers/header/struct.Header.html" target="_blank" rel="noopener noreferrer"><code>Header&lt;T&gt;</code></a> to extract a specific header from the request or <a href="https://docs.rs/volga/latest/volga/headers/header/struct.HttpHeaders.html" target="_blank" rel="noopener noreferrer"><code>HttpHeaders</code></a> to get the full <a href="https://docs.rs/http/latest/http/header/struct.HeaderMap.html" target="_blank" rel="noopener noreferrer"><code>HeaderMap</code></a> read-only snapshot.</p><h3 id="using-header-t" tabindex="-1"><a class="header-anchor" href="#using-header-t"><span>Using <code>Header&lt;T&gt;</code></span></a></h3><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code class="language-rust"><span class="line"><span class="token keyword">use</span> <span class="token namespace">volga<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">App</span><span class="token punctuation">,</span> ok<span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">use</span> <span class="token namespace">volga<span class="token punctuation">::</span>headers<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Header</span><span class="token punctuation">,</span> <span class="token class-name">ContentType</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token attribute attr-name">#[tokio::main]</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token keyword">mut</span> app <span class="token operator">=</span> <span class="token class-name">App</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    app<span class="token punctuation">.</span><span class="token function">map_get</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">,</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>content_type<span class="token punctuation">:</span> <span class="token class-name">Header</span><span class="token operator">&lt;</span><span class="token class-name">ContentType</span><span class="token operator">&gt;</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token keyword">async</span> <span class="token keyword">move</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token macro property">ok!</span><span class="token punctuation">(</span><span class="token string">&quot;{content_type}&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    app<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can test this by sending a request with the <code>curl</code>:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token operator">&gt;</span> <span class="token function">curl</span> <span class="token string">&quot;http://127.0.0.1:7878/hello&quot;</span> <span class="token parameter variable">-H</span> <span class="token string">&quot;content-type: text/plain&quot;</span></span>
<span class="line">Content-Type: text/plain</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="reading-a-custom-http-header-with-header-t" tabindex="-1"><a class="header-anchor" href="#reading-a-custom-http-header-with-header-t"><span>Reading a custom HTTP header with <code>Header&lt;T&gt;</code></span></a></h3><p>If you need to read some custom HTTP header, you can specify a <strong>unit struct</strong> that describes your header and then implement the <a href="https://docs.rs/volga/latest/volga/headers/trait.FromHeaders.html" target="_blank" rel="noopener noreferrer"><code>FromHeaders</code></a> trait for it, here is the example of how you can do it:</p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code class="language-rust"><span class="line"><span class="token keyword">use</span> <span class="token namespace">volga<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">App</span><span class="token punctuation">,</span> ok<span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">use</span> <span class="token namespace">volga<span class="token punctuation">::</span>headers<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Header</span><span class="token punctuation">,</span> <span class="token class-name">FromHeaders</span><span class="token punctuation">,</span> <span class="token class-name">HeaderMap</span><span class="token punctuation">,</span> <span class="token class-name">HeaderName</span><span class="token punctuation">,</span> <span class="token class-name">HeaderValue</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// The \`x-api-key\` header</span></span>
<span class="line"><span class="token keyword">struct</span> <span class="token type-definition class-name">ApiKey</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// FromHeaders trait implementation for ApiKey header</span></span>
<span class="line"><span class="token keyword">impl</span> <span class="token class-name">FromHeaders</span> <span class="token keyword">for</span> <span class="token class-name">ApiKey</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token constant">NAME</span><span class="token punctuation">:</span> <span class="token class-name">HeaderName</span> <span class="token operator">=</span> <span class="token class-name">HeaderName</span><span class="token punctuation">::</span><span class="token function">from_static</span><span class="token punctuation">(</span><span class="token string">&quot;x-api-key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// Reading the header from request&#39;s HeaderMap </span></span>
<span class="line">    <span class="token keyword">fn</span> <span class="token function-definition function">from_headers</span><span class="token punctuation">(</span>headers<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">HeaderMap</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token class-name">HeaderValue</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token function">header_type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token attribute attr-name">#[tokio::main]</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token keyword">mut</span> app <span class="token operator">=</span> <span class="token class-name">App</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    app<span class="token punctuation">.</span><span class="token function">map_get</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">,</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>api_key<span class="token punctuation">:</span> <span class="token class-name">Header</span><span class="token operator">&lt;</span><span class="token class-name">ApiKey</span><span class="token operator">&gt;</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token keyword">async</span> <span class="token keyword">move</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token macro property">ok!</span><span class="token punctuation">(</span><span class="token string">&quot;Received {api_key}&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    app<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now you can test this by running <code>curl</code> command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token operator">&gt;</span> <span class="token function">curl</span> <span class="token string">&quot;http://127.0.0.1:7878/hello&quot;</span> <span class="token parameter variable">-H</span> <span class="token string">&quot;x-api-key: 123-321&quot;</span></span>
<span class="line">Received x-api-key: <span class="token number">123</span>-321</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="simplifying-custom-headers-handling-with-headers-macro" tabindex="-1"><a class="header-anchor" href="#simplifying-custom-headers-handling-with-headers-macro"><span>Simplifying custom headers handling with <code>headers!</code> macro</span></a></h3><p>The code above can be simplified by using the <a href="https://docs.rs/volga/latest/volga/macro.headers.html" target="_blank" rel="noopener noreferrer"><code>headers!</code></a> macro, especially if you need to add multiple headers:</p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code class="language-rust"><span class="line"><span class="token keyword">use</span> <span class="token namespace">volga<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">App</span><span class="token punctuation">,</span> ok<span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">use</span> <span class="token namespace">volga<span class="token punctuation">::</span>headers<span class="token punctuation">::</span></span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Header</span><span class="token punctuation">,</span></span>
<span class="line">    headers</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Custom headers</span></span>
<span class="line"><span class="token macro property">headers!</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token punctuation">(</span><span class="token class-name">ApiKey</span><span class="token punctuation">,</span> <span class="token string">&quot;x-api-key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">(</span><span class="token class-name">CorrelationId</span><span class="token punctuation">,</span> <span class="token string">&quot;x-corr-id&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token attribute attr-name">#[tokio::main]</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token keyword">mut</span> app <span class="token operator">=</span> <span class="token class-name">App</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    app<span class="token punctuation">.</span><span class="token function">map_get</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">,</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>api_key<span class="token punctuation">:</span> <span class="token class-name">Header</span><span class="token operator">&lt;</span><span class="token class-name">ApiKey</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> corr_id<span class="token punctuation">:</span> <span class="token class-name">Header</span><span class="token operator">&lt;</span><span class="token class-name">CorrelationId</span><span class="token operator">&gt;</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token keyword">async</span> <span class="token keyword">move</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token macro property">ok!</span><span class="token punctuation">(</span><span class="token string">&quot;Received {api_key}; {corr_id}&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    app<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And then you can test this by running <code>curl</code> command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token operator">&gt;</span> <span class="token function">curl</span> <span class="token string">&quot;http://127.0.0.1:7878/hello&quot;</span> <span class="token parameter variable">-H</span> <span class="token string">&quot;x-api-key: 123-321&quot;</span> <span class="token parameter variable">-H</span> <span class="token string">&quot;x-corr-id: 456-654&quot;</span></span>
<span class="line">Received x-api-key: <span class="token number">123</span>-321<span class="token punctuation">;</span> correlation-id: <span class="token number">456</span>-654</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="using-httpheaders" tabindex="-1"><a class="header-anchor" href="#using-httpheaders"><span>Using <code>HttpHeaders</code></span></a></h3><p>The same can be achieved also by using <a href="https://docs.rs/volga/latest/volga/headers/header/struct.HttpHeaders.html" target="_blank" rel="noopener noreferrer"><code>HttpHeaders</code></a> struct:</p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code class="language-rust"><span class="line"><span class="token keyword">use</span> <span class="token namespace">volga<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">App</span><span class="token punctuation">,</span> ok<span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">use</span> <span class="token namespace">volga<span class="token punctuation">::</span>headers<span class="token punctuation">::</span></span><span class="token class-name">HttpHeaders</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token attribute attr-name">#[tokio::main]</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token keyword">mut</span> app <span class="token operator">=</span> <span class="token class-name">App</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    app<span class="token punctuation">.</span><span class="token function">map_get</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">,</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>headers<span class="token punctuation">:</span> <span class="token class-name">HttpHeaders</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token keyword">async</span> <span class="token keyword">move</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">let</span> api_key <span class="token operator">=</span> headers<span class="token punctuation">.</span><span class="token function">get_raw</span><span class="token punctuation">(</span><span class="token string">&quot;x-api-key&quot;</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">to_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">ok!</span><span class="token punctuation">(</span><span class="token string">&quot;Received x-api-key: {api_key}&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    app<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can test this by sending a request with the <code>curl</code>:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token operator">&gt;</span> <span class="token function">curl</span> <span class="token string">&quot;http://127.0.0.1:7878/hello&quot;</span> <span class="token parameter variable">-H</span> <span class="token string">&quot;x-api-key: 123-321&quot;</span></span>
<span class="line">Received x-api-key: <span class="token number">123</span>-321</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="using-http-header" tabindex="-1"><a class="header-anchor" href="#using-http-header"><span>Using <code>http_header</code></span></a></h3><p>Another convenient way to work with custom HTTP headers in Volga is the <a href="https://docs.rs/volga/latest/volga/headers/attr.http_header.html" target="_blank" rel="noopener noreferrer"><code>http_header</code></a> attribute macro. It’s especially useful when you want to define strongly-typed header wrappers with clear semantics.</p><p>Here’s an example of how to create and use a custom header:</p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code class="language-rust"><span class="line"><span class="token keyword">use</span> <span class="token namespace">volga<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">App</span><span class="token punctuation">,</span> ok<span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">use</span> <span class="token namespace">volga<span class="token punctuation">::</span>headers<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Header</span><span class="token punctuation">,</span> <span class="token class-name">HttpHeaders</span><span class="token punctuation">,</span> http_header<span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Define a custom header type</span></span>
<span class="line"><span class="token attribute attr-name">#[http_header(<span class="token string">&quot;x-api-key&quot;</span>)]</span></span>
<span class="line"><span class="token keyword">struct</span> <span class="token type-definition class-name">ApiKey</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token attribute attr-name">#[tokio::main]</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token keyword">mut</span> app <span class="token operator">=</span> <span class="token class-name">App</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    app<span class="token punctuation">.</span><span class="token function">map_get</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">,</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>headers<span class="token punctuation">:</span> <span class="token class-name">HttpHeaders</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token keyword">async</span> <span class="token keyword">move</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">let</span> api_key<span class="token punctuation">:</span> <span class="token class-name">Header</span><span class="token operator">&lt;</span><span class="token class-name">ApiKey</span><span class="token operator">&gt;</span> <span class="token operator">=</span> headers<span class="token punctuation">.</span><span class="token function">try_get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">ok!</span><span class="token punctuation">(</span><span class="token string">&quot;Received {api_key}&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    app<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can test the endpoint with <code>curl</code>:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">curl</span> <span class="token string">&quot;http://127.0.0.1:7878/hello&quot;</span> <span class="token parameter variable">-H</span> <span class="token string">&quot;x-api-key: 123-321&quot;</span></span>
<span class="line">Received x-api-key: <span class="token number">123</span>-321</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">Info</p><p>The <a href="https://docs.rs/volga/latest/volga/headers/attr.http_header.html" target="_blank" rel="noopener noreferrer"><code>http_header</code></a> macro is part of the optional <code>macros</code> feature. Make sure to enable it in your <code>Cargo.toml</code>:</p><div class="language-toml line-numbers-mode" data-highlighter="prismjs" data-ext="toml"><pre><code class="language-toml"><span class="line"><span class="token key property">volga</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span> <span class="token key property">version</span> <span class="token punctuation">=</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span> <span class="token key property">features</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;macros&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><h2 id="writing-response-headers" tabindex="-1"><a class="header-anchor" href="#writing-response-headers"><span>Writing Response Headers</span></a></h2><p>The easiest way to respond with HTTP headers using the <a href="https://docs.rs/volga/latest/volga/macro.ok.html" target="_blank" rel="noopener noreferrer"><code>ok!</code></a> macro:</p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code class="language-rust"><span class="line"><span class="token keyword">use</span> <span class="token namespace">volga<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">App</span><span class="token punctuation">,</span> ok<span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token attribute attr-name">#[tokio::main]</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">   <span class="token keyword">let</span> <span class="token keyword">mut</span> app <span class="token operator">=</span> <span class="token class-name">App</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">   app<span class="token punctuation">.</span><span class="token function">map_get</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">,</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token keyword">async</span> <span class="token punctuation">{</span></span>
<span class="line">       <span class="token macro property">ok!</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span></span>
<span class="line">           <span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/plain&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">           <span class="token punctuation">(</span><span class="token string">&quot;x-api-key&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;some api key&quot;</span><span class="token punctuation">)</span></span>
<span class="line">       <span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">   app<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This approach combines response content and headers succinctly, making your code more readable and maintainable.</p><p>Execute the following <code>curl</code> command to see the headers in action:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token operator">&gt;</span> <span class="token function">curl</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;http://127.0.0.1:7878/hello&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>The response will include your custom headers:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">* Host localhost:7878 was resolved.</span>
<span class="line">* IPv6: ::1</span>
<span class="line">* IPv4: <span class="token number">127.0</span>.0.1</span>
<span class="line">*   Trying <span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:7878<span class="token punctuation">..</span>.</span>
<span class="line">* Connected to localhost <span class="token punctuation">(</span>::1<span class="token punctuation">)</span> port <span class="token number">7878</span></span>
<span class="line"><span class="token operator">&gt;</span> GET /hello HTTP/1.1</span>
<span class="line"><span class="token operator">&gt;</span> Host: localhost:7878</span>
<span class="line"><span class="token operator">&gt;</span> User-Agent: curl/8.9.1</span>
<span class="line"><span class="token operator">&gt;</span> Accept: */*</span>
<span class="line"><span class="token operator">&gt;</span></span>
<span class="line">* Request completely sent off</span>
<span class="line"><span class="token operator">&lt;</span> HTTP/1.1 <span class="token number">200</span> OK</span>
<span class="line"><span class="token operator">&lt;</span> date: Sun, <span class="token number">6</span> Oct <span class="token number">2024</span> 08:22:17 +0000</span>
<span class="line"><span class="token operator">&lt;</span> server: Volga</span>
<span class="line"><span class="token operator">&lt;</span> content-length: <span class="token number">12</span></span>
<span class="line"><span class="token operator">&lt;</span> content-type: text/plain</span>
<span class="line"><span class="token operator">&lt;</span> x-api-key: some api key</span>
<span class="line"><span class="token operator">&lt;</span></span>
<span class="line">* Connection <span class="token comment">#0 to host localhost left intact</span></span>
<span class="line">Hello World<span class="token operator">!</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Check out the full examples <a href="https://github.com/RomanEmreis/volga/blob/main/examples/headers/src/main.rs" target="_blank" rel="noopener noreferrer">here</a> and <a href="https://github.com/RomanEmreis/volga/blob/main/examples/custom_request_headers/src/main.rs" target="_blank" rel="noopener noreferrer">here</a></p>`,39)]))}const i=n(t,[["render",o]]),u=JSON.parse('{"path":"/en/requests-responses/headers.html","title":"Headers","lang":"en-US","frontmatter":{},"git":{"updatedTime":1770482703000,"contributors":[{"name":"Roman Emreis","username":"","email":"r.emreis@outloo.com","commits":18},{"name":"RomanEmreis","username":"RomanEmreis","email":"39233213+RomanEmreis@users.noreply.github.com","commits":4,"url":"https://github.com/RomanEmreis"}],"changelog":[{"hash":"65fa823c83e2aa31986d88d1e4e8a20152fad2c2","time":1770482703000,"email":"39233213+RomanEmreis@users.noreply.github.com","author":"Roman","message":"Replace docs root README with redirect to /en (#13)"},{"hash":"86fd152619a7c38bb9612520c2218b7b5ac40cb4","time":1768769697000,"email":"39233213+RomanEmreis@users.noreply.github.com","author":"Roman","message":"Refactor middleware example for improved clarity (#9)"},{"hash":"53a947230481769d7454b5a9793d12bc5f150247","time":1768761219000,"email":"39233213+RomanEmreis@users.noreply.github.com","author":"Roman","message":"Reorganize docs sidebar and move SSE to protocols (#6)"},{"hash":"9e2bf9db5feae8da3f7a9bf2efa8a78f23504655","time":1768756585000,"email":"39233213+RomanEmreis@users.noreply.github.com","author":"Roman","message":"Polish docs examples and wording (#4)"},{"hash":"c1efb6574d93d5b386148e5d89de673f79228db1","time":1768749966000,"email":"r.emreis@outlook.com","author":"Roman Emreis","message":"new release"},{"hash":"446f2cb336c3db45ba44b4f07f646b570e054215","time":1753605804000,"email":"r.emreis@outlook.com","author":"Roman Emreis","message":"new release"},{"hash":"d7d673fca21757efa0a4659c63884168bfe315fe","time":1738859397000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"new release"},{"hash":"5d6cdc2c818f56d2f0f360e08643446a9e8c2e1f","time":1736868027000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"new release"},{"hash":"f0a26f29858451307785105c897483568f99fc00","time":1734955827000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"new release"},{"hash":"7bc27d7af6a3b3ba979653e271bc7eff4c42ca89","time":1734360674000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"new release"},{"hash":"f0037af58dc97687ba72649b07f83f74a67cb2ba","time":1733923146000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"typo fix"},{"hash":"b728e47449654a6e1994ac59540bda945dfe8db9","time":1733922899000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"new release"},{"hash":"c103c93458ddf9a62b8b085ade6d01e097179d4d","time":1733565170000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"several fixes"},{"hash":"a44e23ce545d4453147935818ef67beaf4a90531","time":1733501332000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"new docs site"},{"hash":"f7b99f9f4d378ce79ae15accc2e14dd549cb8c6b","time":1732360723000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"new release"},{"hash":"cc3d5a5b64e130f6529221219529324fed91160e","time":1731923958000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"new release"},{"hash":"c6a68d00de7c0a5d851f6d23397cea1ea5421bfe","time":1730631164000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"new release"},{"hash":"b480008a730d0424109908ff79bd425c5e2eae8f","time":1730024614000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"new release"},{"hash":"6c9d33393fb02e45b8732a053720cc350af3d5d9","time":1728663592000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"new release"},{"hash":"f068acea62a0b56ede3308ba4527dc0af65bc923","time":1728312982000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"added json and middleware docs"},{"hash":"02c0432aaa5f4058e596f75f2556e2ae47ceb0ad","time":1728292816000,"email":"Roman_Emreis@epam.com","author":"Roman Emreis","message":"added headers and query params documentation"},{"hash":"574a918a67f81749754c3ab0905a174bf7f5e91a","time":1728205697000,"email":"r.emreis@outloo.com","author":"Roman Emreis","message":"Initial commit"}]},"filePathRelative":"en/requests-responses/headers.md"}');export{i as comp,u as data};
